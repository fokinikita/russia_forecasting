# Russian Forecasting: ML vs Classic Econometrics Models

Проект посвящён сравнению **ML-моделей** и **классических эконометрических подходов**
для прогнозирования основных **макроэкономических показателей России**.

---

## Планы
В будущем планируется автоматический парсер всех данных и построение прогнозов на основе моделей на 1.5-2 года вперед,
пока все работает на вручную собранных таблицах 

## Используемые модели

### Machine Learning
- **CatBoost**
- **NGBoost**
- **TabNet**

### Эконометрические модели
- **MFBVAR (Mixed-Frequency Bayesian VAR)**
- **DFM (Dynamic Factor Model)**
- **Наивный бенчмарк** (random walk / последнее известное значение)

---
# Данные

Все переменные-фичи (63 переменных) можно найти в var_naming.xlsx с обозначениями на английском и источниками

## Прогнозируемые показатели

- Основные макроэкономические переменные РФ  (в постоянных ценах)
  1) ВВП,  
  2) потребление домашних хозяйств
  3) валовое накопление
  4) валовое накопление основного капитаола

> Все данные уже находятся в проекте,
> 
> пути можно найти в config.py
> 
> при необходимости можно поменять, но без изменения все должно запуститься из коробки

---

## Структура проекта

```text
giga_data/
├── main.py                  # Точка входа
├── pipelines/               # Отдельные классы для всех моделей
├── data/                    # Данные (excel таблицы)
├── models/                  # Реализации моделей (все кроме mfbvar, так как она реализована в R, о ней ниже)
├── metrics/                 # Класс для расчетов метрик качества прогнозов
├── config.py                # файл с настройками моделей/путей и так далее
├── pyproject.toml
├── poetry.lock
└── README.md
```

## MFBVAR в R:
Пакет mfbvar удален из кран, но его архив лежит в репозитории, им можно воспользоваться
в крайнем случае скачать тут https://cran.r-project.org/src/contrib/Archive/mfbvar/
mfbvar_0.5.6.tar.gz	2021-02-10 12:00	 
и установить через ```install.packages```

Если этот пакет успешно установлен, то можно просто запустить весь скрипт mfbvar.R
паралелельно с main.py в Python.

Можно не запускать mfbvar, тогда метрики по этой модели рассчитаны не будут,
но тогда в main.py

```run_metrics(calculate_mfbvar=True)``` 
нужно поменять на
```run_metrics(calculate_mfbvar=False)```

# Запуск и репликация
## Первый вариант
Просто посчитать метрики на готовых прогнозах в папке preds
можно использовать ноутбук metrics.ipynb

## Второй вариант
Гарантированный реплицированный запуск (с расчетом всех моделей на вашей машине) можно получить через poetry

```poetry run python main.py```

в таком случае будут использоваться одни и те же версии всех библиотек
можно и просто запустить
python main.py, но метрики могут отличаться из-за версий библиотек, хотя random_seed везде зафиксирован


